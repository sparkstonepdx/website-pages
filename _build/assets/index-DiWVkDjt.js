import{g as u,a,i as l,t as d,u as B}from"./web-y9Kcdmxi.js";import{n as D,p as L,e as M}from"./parse-markdown-C61Y4UXr.js";import{r as O,b as c}from"./solid-DK4Op-bj.js";import{H as U}from"./header-Bh88TvH3.js";import{g,C as W}from"./collection-form-CiKciYXr.js";import{u as q}from"./config-context-Bqa-_nJu.js";import{S as z}from"./showWhenResource-Cv3sTxUG.js";import{u as A,h as G,i as I}from"./sparkstone-logo-full-BMoF2ggk.js";var J=d('<form><header class="flex flip"><h2 style=margin:0>Editing <!$><!/></h2><div style=flex-grow:1></div><button>Publish</button></header><hr><!$><!/>'),K=d("<main class=container><!$><!/><hr><!$><!/>");function ne(Q){const[i]=q(),s=A();G();const n=()=>i()?.collections?.[s.collection],{formSubmit:h,errors:_,validate:p}=D(),b=I(),[m]=O(()=>({entry:s.entry,collection:n()}),async({entry:e,collection:r})=>{if(r)return await fetch(`${g(i())}/storage/file/${r?.folder}${e}`).then(t=>t.text()).then(t=>L(r,t))});async function x(e){const r=Object.fromEntries(new FormData(e).entries()),t=await M(n(),r);await fetch(`${g(i())}/storage/file/${n()?.folder}/${s.entry}`,{method:"put",body:t}),e.reset(),b(`/admin?collection=${n().name}`)}return(()=>{var e=u(K),r=e.firstChild,[t,S]=a(r.nextSibling),y=t.nextSibling,C=y.nextSibling,[v,w]=a(C.nextSibling);return l(e,c(U,{}),t,S),l(e,c(z,{resources:[i,m],get children(){var o=u(J),$=o.firstChild,f=$.firstChild,E=f.firstChild,P=E.nextSibling,[N,R]=a(P.nextSibling),k=$.nextSibling,F=k.nextSibling,[H,j]=a(F.nextSibling);return B(h,o,()=>x),l(f,()=>n()?.label,N,R),l(o,c(W,{get collection(){return n()},get defaults(){return m()},errors:_,validate:p}),H,j),o}}),v,w),e})()}export{ne as default};
